{
  "version": 3,
  "sources": ["../js/lib/toast.js", "../js/admin-bad-phrases.js"],
  "sourcesContent": ["export function showToast(message, { variant = 'primary', delay = 4000 } = {}) {\n  const container = document.querySelector('.toast-container');\n  if (!container) {\n    console.warn('[toast] Missing .toast-container');\n    return;\n  }\n  const el = document.createElement('div');\n  el.className = `toast align-items-center text-bg-${variant} border-0`;\n  el.role = 'alert';\n  el.ariaLive = 'assertive';\n  el.ariaAtomic = 'true';\n  el.innerHTML = `<div class=\"d-flex\"><div class=\"toast-body\">${message}</div><button type=\"button\" class=\"btn-close btn-close-white me-2 m-auto\" data-bs-dismiss=\"toast\" aria-label=\"Close\"></button></div>`;\n  container.appendChild(el);\n  if (window.bootstrap && window.bootstrap.Toast) {\n    const toast = new window.bootstrap.Toast(el, { autohide: true, delay });\n    toast.show();\n    el.addEventListener('hidden.bs.toast', () => el.remove());\n  }\n}\n", "import { showToast } from './lib/toast.js';\n\n(function () {\n  const PAGE_SIZE = 10;\n  let currentPage = 1;\n  let currentSearch = '';\n\n  const tbody = document.getElementById('phrasesTableBody');\n  const paginationUl = document.getElementById('pagination');\n  const loadingSpinner = document.getElementById('loadingSpinner');\n\n  const phraseModalEl = document.getElementById('phraseModal');\n  let phraseModal = null;\n  if (phraseModalEl && window.bootstrap) {\n    phraseModal = window.bootstrap.Modal.getOrCreateInstance(phraseModalEl);\n  }\n  const phraseForm = document.getElementById('phraseForm');\n  const phraseInput = document.getElementById('phraseInput');\n  const scoreInput = document.getElementById('scoreInput');\n  const phraseIdInput = document.getElementById('phraseIdInput');\n  const modalTitle = phraseModalEl.querySelector('.modal-title');\n\n  function showLoadingSpinner() {\n    loadingSpinner.classList.remove('d-none', 'fade');\n  }\n  function hideLoadingSpinner() {\n    loadingSpinner.classList.add('fade');\n    setTimeout(() => loadingSpinner.classList.add('d-none'), 150);\n  }\n\n  function renderPagination(pagination) {\n    const totalPages = pagination.totalPages || 1;\n    paginationUl.innerHTML = '';\n    if (totalPages <= 1) {\n      return;\n    }\n    // Condensed pagination: show first, prev, current window, next, last\n    const windowSize = 5;\n    const start = Math.max(1, currentPage - Math.floor(windowSize / 2));\n    const end = Math.min(totalPages, start + windowSize - 1);\n\n    const addPage = (i, label = null, disabled = false) => {\n      const li = document.createElement('li');\n      li.className = `page-item ${i === currentPage ? 'active' : ''} ${disabled ? 'disabled' : ''}`;\n      const a = document.createElement('a');\n      a.className = 'page-link';\n      a.href = '#';\n      a.textContent = label || i;\n      a.addEventListener('click', (e) => {\n        e.preventDefault();\n        if (disabled) {\n          return;\n        }\n        currentPage = i;\n        fetchPage();\n      });\n      li.appendChild(a);\n      paginationUl.appendChild(li);\n    };\n\n    addPage(1, '\u00AB', currentPage === 1);\n    addPage(Math.max(1, currentPage - 1), '\u2039', currentPage === 1);\n    for (let i = start; i <= end; i++) {\n      addPage(i);\n    }\n    addPage(Math.min(totalPages, currentPage + 1), '\u203A', currentPage === totalPages);\n    addPage(totalPages, '\u00BB', currentPage === totalPages);\n  }\n\n  function renderTable() {\n    tbody.innerHTML = '';\n    if (\n      !window.__phrasesPage ||\n      !Array.isArray(window.__phrasesPage.items) ||\n      window.__phrasesPage.items.length === 0\n    ) {\n      const tr = document.createElement('tr');\n      tr.innerHTML = '<td colspan=\"3\" class=\"text-muted\">No phrases found.</td>';\n      tbody.appendChild(tr);\n    } else {\n      window.__phrasesPage.items.forEach((p) => tbody.appendChild(rowFor(p)));\n    }\n    renderPagination(window.__phrasesPage.pagination);\n  }\n\n  function rowFor(p) {\n    const tr = document.createElement('tr');\n    tr.innerHTML = `\n      <td>${p.phrase}</td>\n      <td>${Number(p.score)}</td>\n      <td class=\"text-end\">\n        <button class=\"btn btn-sm btn-outline-primary\" data-edit-phrase data-id=\"${p.id}\" title=\"Edit\" data-bs-toggle=\"modal\" data-bs-target=\"#phraseModal\">\n          <i class=\"bi bi-pencil-square\"></i>\n        </button>\n        <button class=\"btn btn-sm btn-outline-danger\" data-delete-phrase data-id=\"${p.id}\" title=\"Delete\">\n          <i class=\"bi bi-trash\"></i>\n        </button>\n      </td>\n    `;\n    return tr;\n  }\n\n  async function fetchPage() {\n    showLoadingSpinner();\n    try {\n      const params = new URLSearchParams({\n        page: String(currentPage),\n        limit: String(PAGE_SIZE),\n        search: currentSearch\n      });\n      const res = await fetch(`/api/v3/bad-phrases?${params.toString()}`, {\n        credentials: 'same-origin'\n      });\n      if (!res.ok) {\n        throw new Error(`${res.status} ${res.statusText}`);\n      }\n      const data = await res.json();\n      window.__phrasesPage = data;\n      renderTable();\n    } catch (e) {\n      console.error(e);\n      tbody.innerHTML = '<tr><td colspan=\"3\" class=\"text-danger\">Error loading phrases.</td></tr>';\n    } finally {\n      hideLoadingSpinner();\n    }\n  }\n\n  document.getElementById('searchForm').addEventListener('submit', (e) => {\n    e.preventDefault();\n    currentSearch = document.getElementById('phraseSearchInput').value || '';\n    currentPage = 1;\n    currentPage = 1;\n    fetchPage();\n  });\n\n  // Modal show: create or edit\n  phraseModalEl.addEventListener('show.bs.modal', (event) => {\n    const button = event.relatedTarget;\n    const id = button ? button.getAttribute('data-id') : null;\n    phraseForm.reset();\n    phraseIdInput.value = '';\n    if (id) {\n      const existing = window.__phrasesPage.items.find((x) => String(x.id) === String(id));\n      if (existing) {\n        modalTitle.textContent = 'Edit Phrase';\n        phraseIdInput.value = existing.id;\n        phraseInput.value = existing.phrase;\n        scoreInput.value = existing.score;\n      }\n    } else {\n      modalTitle.textContent = 'Create Phrase';\n    }\n  });\n\n  // Focus the phrase input when the modal is fully shown\n  phraseModalEl.addEventListener('shown.bs.modal', () => {\n    if (phraseInput) {\n      phraseInput.focus();\n      // Move cursor to end for convenience\n      const val = phraseInput.value;\n      phraseInput.value = '';\n      phraseInput.value = val;\n    }\n  });\n\n  phraseForm.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    const id = phraseIdInput.value;\n    const method = id ? 'PUT' : 'POST';\n    const url = id ? `/api/v3/bad-phrases/${id}` : '/api/v3/bad-phrases';\n    const payload = { phrase: phraseInput.value.trim(), score: Number(scoreInput.value || 0.5) };\n    try {\n      showLoadingSpinner();\n      const res = await fetch(url, {\n        method,\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'same-origin',\n        body: JSON.stringify(payload)\n      });\n      if (!res.ok) {\n        const err = await res.json().catch(() => ({}));\n        throw new Error(err.error || 'Save failed');\n      }\n      // Hide modal then refresh list and toast\n      phraseModalEl.addEventListener(\n        'hidden.bs.modal',\n        () => {\n          const backdrop = document.querySelector('.modal-backdrop');\n          if (backdrop) {\n            backdrop.remove();\n          }\n          showToast('Saved', { variant: 'success' });\n          fetchPage();\n        },\n        { once: true }\n      );\n      if (phraseModal) {\n        phraseModal.hide();\n      }\n    } catch (err) {\n      console.error(err);\n      showToast(err.message || 'Error saving', { variant: 'danger' });\n    } finally {\n      hideLoadingSpinner();\n    }\n  });\n\n  document.body.addEventListener('click', async (e) => {\n    const delBtn = e.target.closest('[data-delete-phrase]');\n    const editBtn = e.target.closest('[data-edit-phrase]');\n    if (delBtn) {\n      const id = delBtn.getAttribute('data-id');\n      if (!confirm('Delete this phrase?')) {\n        return;\n      }\n      try {\n        showLoadingSpinner();\n        const res = await fetch(`/api/v3/bad-phrases/${id}`, {\n          method: 'DELETE',\n          credentials: 'same-origin'\n        });\n        if (!res.ok) {\n          throw new Error('Delete failed');\n        }\n        showToast('Deleted', { variant: 'success' });\n        fetchPage();\n      } catch (err) {\n        console.error(err);\n        showToast('Delete failed', { variant: 'danger' });\n      } finally {\n        hideLoadingSpinner();\n      }\n    }\n    if (editBtn) {\n      // The Bootstrap data attributes trigger modal show; nothing else needed here\n    }\n  });\n\n  document.addEventListener('DOMContentLoaded', fetchPage);\n})();\n"],
  "mappings": ";;AAAO,WAAS,UAAU,SAAS,EAAE,UAAU,WAAW,QAAQ,IAAK,IAAI,CAAC,GAAG;AAC7E,UAAM,YAAY,SAAS,cAAc,kBAAkB;AAC3D,QAAI,CAAC,WAAW;AACd,cAAQ,KAAK,kCAAkC;AAC/C;AAAA,IACF;AACA,UAAM,KAAK,SAAS,cAAc,KAAK;AACvC,OAAG,YAAY,oCAAoC,OAAO;AAC1D,OAAG,OAAO;AACV,OAAG,WAAW;AACd,OAAG,aAAa;AAChB,OAAG,YAAY,+CAA+C,OAAO;AACrE,cAAU,YAAY,EAAE;AACxB,QAAI,OAAO,aAAa,OAAO,UAAU,OAAO;AAC9C,YAAM,QAAQ,IAAI,OAAO,UAAU,MAAM,IAAI,EAAE,UAAU,MAAM,MAAM,CAAC;AACtE,YAAM,KAAK;AACX,SAAG,iBAAiB,mBAAmB,MAAM,GAAG,OAAO,CAAC;AAAA,IAC1D;AAAA,EACF;;;AChBA,GAAC,WAAY;AACX,UAAM,YAAY;AAClB,QAAI,cAAc;AAClB,QAAI,gBAAgB;AAEpB,UAAM,QAAQ,SAAS,eAAe,kBAAkB;AACxD,UAAM,eAAe,SAAS,eAAe,YAAY;AACzD,UAAM,iBAAiB,SAAS,eAAe,gBAAgB;AAE/D,UAAM,gBAAgB,SAAS,eAAe,aAAa;AAC3D,QAAI,cAAc;AAClB,QAAI,iBAAiB,OAAO,WAAW;AACrC,oBAAc,OAAO,UAAU,MAAM,oBAAoB,aAAa;AAAA,IACxE;AACA,UAAM,aAAa,SAAS,eAAe,YAAY;AACvD,UAAM,cAAc,SAAS,eAAe,aAAa;AACzD,UAAM,aAAa,SAAS,eAAe,YAAY;AACvD,UAAM,gBAAgB,SAAS,eAAe,eAAe;AAC7D,UAAM,aAAa,cAAc,cAAc,cAAc;AAE7D,aAAS,qBAAqB;AAC5B,qBAAe,UAAU,OAAO,UAAU,MAAM;AAAA,IAClD;AACA,aAAS,qBAAqB;AAC5B,qBAAe,UAAU,IAAI,MAAM;AACnC,iBAAW,MAAM,eAAe,UAAU,IAAI,QAAQ,GAAG,GAAG;AAAA,IAC9D;AAEA,aAAS,iBAAiB,YAAY;AACpC,YAAM,aAAa,WAAW,cAAc;AAC5C,mBAAa,YAAY;AACzB,UAAI,cAAc,GAAG;AACnB;AAAA,MACF;AAEA,YAAM,aAAa;AACnB,YAAM,QAAQ,KAAK,IAAI,GAAG,cAAc,KAAK,MAAM,aAAa,CAAC,CAAC;AAClE,YAAM,MAAM,KAAK,IAAI,YAAY,QAAQ,aAAa,CAAC;AAEvD,YAAM,UAAU,CAAC,GAAG,QAAQ,MAAM,WAAW,UAAU;AACrD,cAAM,KAAK,SAAS,cAAc,IAAI;AACtC,WAAG,YAAY,aAAa,MAAM,cAAc,WAAW,EAAE,IAAI,WAAW,aAAa,EAAE;AAC3F,cAAM,IAAI,SAAS,cAAc,GAAG;AACpC,UAAE,YAAY;AACd,UAAE,OAAO;AACT,UAAE,cAAc,SAAS;AACzB,UAAE,iBAAiB,SAAS,CAAC,MAAM;AACjC,YAAE,eAAe;AACjB,cAAI,UAAU;AACZ;AAAA,UACF;AACA,wBAAc;AACd,oBAAU;AAAA,QACZ,CAAC;AACD,WAAG,YAAY,CAAC;AAChB,qBAAa,YAAY,EAAE;AAAA,MAC7B;AAEA,cAAQ,GAAG,QAAK,gBAAgB,CAAC;AACjC,cAAQ,KAAK,IAAI,GAAG,cAAc,CAAC,GAAG,UAAK,gBAAgB,CAAC;AAC5D,eAAS,IAAI,OAAO,KAAK,KAAK,KAAK;AACjC,gBAAQ,CAAC;AAAA,MACX;AACA,cAAQ,KAAK,IAAI,YAAY,cAAc,CAAC,GAAG,UAAK,gBAAgB,UAAU;AAC9E,cAAQ,YAAY,QAAK,gBAAgB,UAAU;AAAA,IACrD;AAEA,aAAS,cAAc;AACrB,YAAM,YAAY;AAClB,UACE,CAAC,OAAO,iBACR,CAAC,MAAM,QAAQ,OAAO,cAAc,KAAK,KACzC,OAAO,cAAc,MAAM,WAAW,GACtC;AACA,cAAM,KAAK,SAAS,cAAc,IAAI;AACtC,WAAG,YAAY;AACf,cAAM,YAAY,EAAE;AAAA,MACtB,OAAO;AACL,eAAO,cAAc,MAAM,QAAQ,CAAC,MAAM,MAAM,YAAY,OAAO,CAAC,CAAC,CAAC;AAAA,MACxE;AACA,uBAAiB,OAAO,cAAc,UAAU;AAAA,IAClD;AAEA,aAAS,OAAO,GAAG;AACjB,YAAM,KAAK,SAAS,cAAc,IAAI;AACtC,SAAG,YAAY;AAAA,YACP,EAAE,MAAM;AAAA,YACR,OAAO,EAAE,KAAK,CAAC;AAAA;AAAA,mFAEwD,EAAE,EAAE;AAAA;AAAA;AAAA,oFAGH,EAAE,EAAE;AAAA;AAAA;AAAA;AAAA;AAKpF,aAAO;AAAA,IACT;AAEA,mBAAe,YAAY;AACzB,yBAAmB;AACnB,UAAI;AACF,cAAM,SAAS,IAAI,gBAAgB;AAAA,UACjC,MAAM,OAAO,WAAW;AAAA,UACxB,OAAO,OAAO,SAAS;AAAA,UACvB,QAAQ;AAAA,QACV,CAAC;AACD,cAAM,MAAM,MAAM,MAAM,uBAAuB,OAAO,SAAS,CAAC,IAAI;AAAA,UAClE,aAAa;AAAA,QACf,CAAC;AACD,YAAI,CAAC,IAAI,IAAI;AACX,gBAAM,IAAI,MAAM,GAAG,IAAI,MAAM,IAAI,IAAI,UAAU,EAAE;AAAA,QACnD;AACA,cAAM,OAAO,MAAM,IAAI,KAAK;AAC5B,eAAO,gBAAgB;AACvB,oBAAY;AAAA,MACd,SAAS,GAAG;AACV,gBAAQ,MAAM,CAAC;AACf,cAAM,YAAY;AAAA,MACpB,UAAE;AACA,2BAAmB;AAAA,MACrB;AAAA,IACF;AAEA,aAAS,eAAe,YAAY,EAAE,iBAAiB,UAAU,CAAC,MAAM;AACtE,QAAE,eAAe;AACjB,sBAAgB,SAAS,eAAe,mBAAmB,EAAE,SAAS;AACtE,oBAAc;AACd,oBAAc;AACd,gBAAU;AAAA,IACZ,CAAC;AAGD,kBAAc,iBAAiB,iBAAiB,CAAC,UAAU;AACzD,YAAM,SAAS,MAAM;AACrB,YAAM,KAAK,SAAS,OAAO,aAAa,SAAS,IAAI;AACrD,iBAAW,MAAM;AACjB,oBAAc,QAAQ;AACtB,UAAI,IAAI;AACN,cAAM,WAAW,OAAO,cAAc,MAAM,KAAK,CAAC,MAAM,OAAO,EAAE,EAAE,MAAM,OAAO,EAAE,CAAC;AACnF,YAAI,UAAU;AACZ,qBAAW,cAAc;AACzB,wBAAc,QAAQ,SAAS;AAC/B,sBAAY,QAAQ,SAAS;AAC7B,qBAAW,QAAQ,SAAS;AAAA,QAC9B;AAAA,MACF,OAAO;AACL,mBAAW,cAAc;AAAA,MAC3B;AAAA,IACF,CAAC;AAGD,kBAAc,iBAAiB,kBAAkB,MAAM;AACrD,UAAI,aAAa;AACf,oBAAY,MAAM;AAElB,cAAM,MAAM,YAAY;AACxB,oBAAY,QAAQ;AACpB,oBAAY,QAAQ;AAAA,MACtB;AAAA,IACF,CAAC;AAED,eAAW,iBAAiB,UAAU,OAAO,MAAM;AACjD,QAAE,eAAe;AACjB,YAAM,KAAK,cAAc;AACzB,YAAM,SAAS,KAAK,QAAQ;AAC5B,YAAM,MAAM,KAAK,uBAAuB,EAAE,KAAK;AAC/C,YAAM,UAAU,EAAE,QAAQ,YAAY,MAAM,KAAK,GAAG,OAAO,OAAO,WAAW,SAAS,GAAG,EAAE;AAC3F,UAAI;AACF,2BAAmB;AACnB,cAAM,MAAM,MAAM,MAAM,KAAK;AAAA,UAC3B;AAAA,UACA,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,UAC9C,aAAa;AAAA,UACb,MAAM,KAAK,UAAU,OAAO;AAAA,QAC9B,CAAC;AACD,YAAI,CAAC,IAAI,IAAI;AACX,gBAAM,MAAM,MAAM,IAAI,KAAK,EAAE,MAAM,OAAO,CAAC,EAAE;AAC7C,gBAAM,IAAI,MAAM,IAAI,SAAS,aAAa;AAAA,QAC5C;AAEA,sBAAc;AAAA,UACZ;AAAA,UACA,MAAM;AACJ,kBAAM,WAAW,SAAS,cAAc,iBAAiB;AACzD,gBAAI,UAAU;AACZ,uBAAS,OAAO;AAAA,YAClB;AACA,sBAAU,SAAS,EAAE,SAAS,UAAU,CAAC;AACzC,sBAAU;AAAA,UACZ;AAAA,UACA,EAAE,MAAM,KAAK;AAAA,QACf;AACA,YAAI,aAAa;AACf,sBAAY,KAAK;AAAA,QACnB;AAAA,MACF,SAAS,KAAK;AACZ,gBAAQ,MAAM,GAAG;AACjB,kBAAU,IAAI,WAAW,gBAAgB,EAAE,SAAS,SAAS,CAAC;AAAA,MAChE,UAAE;AACA,2BAAmB;AAAA,MACrB;AAAA,IACF,CAAC;AAED,aAAS,KAAK,iBAAiB,SAAS,OAAO,MAAM;AACnD,YAAM,SAAS,EAAE,OAAO,QAAQ,sBAAsB;AACtD,YAAM,UAAU,EAAE,OAAO,QAAQ,oBAAoB;AACrD,UAAI,QAAQ;AACV,cAAM,KAAK,OAAO,aAAa,SAAS;AACxC,YAAI,CAAC,QAAQ,qBAAqB,GAAG;AACnC;AAAA,QACF;AACA,YAAI;AACF,6BAAmB;AACnB,gBAAM,MAAM,MAAM,MAAM,uBAAuB,EAAE,IAAI;AAAA,YACnD,QAAQ;AAAA,YACR,aAAa;AAAA,UACf,CAAC;AACD,cAAI,CAAC,IAAI,IAAI;AACX,kBAAM,IAAI,MAAM,eAAe;AAAA,UACjC;AACA,oBAAU,WAAW,EAAE,SAAS,UAAU,CAAC;AAC3C,oBAAU;AAAA,QACZ,SAAS,KAAK;AACZ,kBAAQ,MAAM,GAAG;AACjB,oBAAU,iBAAiB,EAAE,SAAS,SAAS,CAAC;AAAA,QAClD,UAAE;AACA,6BAAmB;AAAA,QACrB;AAAA,MACF;AACA,UAAI,SAAS;AAAA,MAEb;AAAA,IACF,CAAC;AAED,aAAS,iBAAiB,oBAAoB,SAAS;AAAA,EACzD,GAAG;",
  "names": []
}
