{
  "version": 3,
  "sources": ["../js/lib/toast.js", "../js/admin-salutations.js"],
  "sourcesContent": ["export function showToast(message, { variant = 'primary', delay = 4000 } = {}) {\n  const container = document.querySelector('.toast-container');\n  if (!container) {\n    console.warn('[toast] Missing .toast-container');\n    return;\n  }\n  const el = document.createElement('div');\n  el.className = `toast align-items-center text-bg-${variant} border-0`;\n  el.role = 'alert';\n  el.ariaLive = 'assertive';\n  el.ariaAtomic = 'true';\n  el.innerHTML = `<div class=\"d-flex\"><div class=\"toast-body\">${message}</div><button type=\"button\" class=\"btn-close btn-close-white me-2 m-auto\" data-bs-dismiss=\"toast\" aria-label=\"Close\"></button></div>`;\n  container.appendChild(el);\n  if (window.bootstrap && window.bootstrap.Toast) {\n    const toast = new window.bootstrap.Toast(el, { autohide: true, delay });\n    toast.show();\n    el.addEventListener('hidden.bs.toast', () => el.remove());\n  }\n}\n", "import { showToast } from './lib/toast.js';\n\n(function () {\n  const PAGE_SIZE = 10;\n  let currentPage = 1;\n  let currentSearch = '';\n  const tbody = document.getElementById('salutationsTableBody');\n  const paginationUl = document.getElementById('pagination');\n  const loadingSpinner = document.getElementById('loadingSpinner');\n\n  const modalEl = document.getElementById('salutationModal');\n  let modal = null;\n  if (modalEl && window.bootstrap) {\n    modal = window.bootstrap.Modal.getOrCreateInstance(modalEl);\n  }\n  const form = document.getElementById('salutationForm');\n  const phraseInput = document.getElementById('salutationPhraseInput');\n  const scoreInput = document.getElementById('salutationScoreInput');\n  const idInput = document.getElementById('salutationIdInput');\n  const modalTitle = modalEl.querySelector('.modal-title');\n\n  function showLoading() {\n    loadingSpinner.classList.remove('d-none', 'fade');\n  }\n  function hideLoading() {\n    loadingSpinner.classList.add('fade');\n    setTimeout(() => loadingSpinner.classList.add('d-none'), 150);\n  }\n\n  function renderPagination(pagination) {\n    const totalPages = pagination.totalPages || 1;\n    paginationUl.innerHTML = '';\n    if (totalPages <= 1) {\n      return;\n    }\n    const windowSize = 5;\n    const start = Math.max(1, currentPage - Math.floor(windowSize / 2));\n    const end = Math.min(totalPages, start + windowSize - 1);\n    const addPage = (i, label = null, disabled = false) => {\n      const li = document.createElement('li');\n      li.className = `page-item ${i === currentPage ? 'active' : ''} ${disabled ? 'disabled' : ''}`;\n      const a = document.createElement('a');\n      a.className = 'page-link';\n      a.href = '#';\n      a.textContent = label || i;\n      a.addEventListener('click', (e) => {\n        e.preventDefault();\n        if (disabled) {\n          return;\n        }\n        currentPage = i;\n        fetchPage();\n      });\n      li.appendChild(a);\n      paginationUl.appendChild(li);\n    };\n    addPage(1, '\u00AB', currentPage === 1);\n    addPage(Math.max(1, currentPage - 1), '\u2039', currentPage === 1);\n    for (let i = start; i <= end; i++) {\n      addPage(i);\n    }\n    addPage(Math.min(totalPages, currentPage + 1), '\u203A', currentPage === totalPages);\n    addPage(totalPages, '\u00BB', currentPage === totalPages);\n  }\n\n  function rowFor(p) {\n    const tr = document.createElement('tr');\n    tr.innerHTML = `<td>${p.phrase}</td><td>${Number(p.score)}</td><td class='text-end'>\n    <button class='btn btn-sm btn-outline-primary' data-edit-salutation data-id='${p.id}' title='Edit' data-bs-toggle='modal' data-bs-target='#salutationModal'><i class='bi bi-pencil-square'></i></button>\n    <button class='btn btn-sm btn-outline-danger' data-delete-salutation data-id='${p.id}' title='Delete'><i class='bi bi-trash'></i></button>\n    </td>`;\n    return tr;\n  }\n\n  function renderTable() {\n    tbody.innerHTML = '';\n    if (\n      !window.__salutationsPage ||\n      !Array.isArray(window.__salutationsPage.items) ||\n      window.__salutationsPage.items.length === 0\n    ) {\n      const tr = document.createElement('tr');\n      tr.innerHTML = '<td colspan=\"3\" class=\"text-muted\">No salutations found.</td>';\n      tbody.appendChild(tr);\n    } else {\n      window.__salutationsPage.items.forEach((p) => tbody.appendChild(rowFor(p)));\n    }\n    renderPagination(window.__salutationsPage.pagination);\n  }\n\n  async function fetchPage() {\n    showLoading();\n    try {\n      const params = new URLSearchParams({\n        page: String(currentPage),\n        limit: String(PAGE_SIZE),\n        search: currentSearch\n      });\n      const res = await fetch(`/api/v3/salutations?${params.toString()}`, {\n        credentials: 'same-origin'\n      });\n      if (!res.ok) {\n        throw new Error(`${res.status} ${res.statusText}`);\n      }\n      const data = await res.json();\n      window.__salutationsPage = data;\n      renderTable();\n    } catch (e) {\n      console.error(e);\n      tbody.innerHTML =\n        '<tr><td colspan=\"3\" class=\"text-danger\">Error loading salutations.</td></tr>';\n    } finally {\n      hideLoading();\n    }\n  }\n\n  document.getElementById('searchForm').addEventListener('submit', (e) => {\n    e.preventDefault();\n    currentSearch = document.getElementById('salutationSearchInput').value || '';\n    currentPage = 1;\n    fetchPage();\n  });\n\n  modalEl.addEventListener('show.bs.modal', (event) => {\n    const btn = event.relatedTarget;\n    const id = btn ? btn.getAttribute('data-id') : null;\n    form.reset();\n    idInput.value = '';\n    scoreInput.value = '0';\n    if (id) {\n      const existing = window.__salutationsPage.items.find((x) => String(x.id) === String(id));\n      if (existing) {\n        modalTitle.textContent = 'Edit Salutation';\n        idInput.value = existing.id;\n        phraseInput.value = existing.phrase;\n        scoreInput.value = existing.score;\n      }\n    } else {\n      modalTitle.textContent = 'Create Salutation';\n    }\n  });\n  modalEl.addEventListener('shown.bs.modal', () => {\n    if (phraseInput) {\n      phraseInput.focus();\n      const v = phraseInput.value;\n      phraseInput.value = '';\n      phraseInput.value = v;\n    }\n  });\n\n  form.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    const id = idInput.value;\n    const method = id ? 'PUT' : 'POST';\n    const url = id ? `/api/v3/salutations/${id}` : '/api/v3/salutations';\n    const payload = { phrase: phraseInput.value.trim(), score: Number(scoreInput.value || 0) };\n    try {\n      showLoading();\n      const res = await fetch(url, {\n        method,\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'same-origin',\n        body: JSON.stringify(payload)\n      });\n      if (!res.ok) {\n        const err = await res.json().catch(() => ({}));\n        throw new Error(err.error || 'Save failed');\n      }\n      modalEl.addEventListener(\n        'hidden.bs.modal',\n        () => {\n          const backdrop = document.querySelector('.modal-backdrop');\n          if (backdrop) {\n            backdrop.remove();\n          }\n          showToast('Saved', { variant: 'success' });\n          fetchPage();\n        },\n        { once: true }\n      );\n      if (modal) {\n        modal.hide();\n      }\n    } catch (err) {\n      console.error(err);\n      showToast(err.message || 'Error saving', { variant: 'danger' });\n    } finally {\n      hideLoading();\n    }\n  });\n\n  document.body.addEventListener('click', async (e) => {\n    const delBtn = e.target.closest('[data-delete-salutation]');\n    if (delBtn) {\n      const id = delBtn.getAttribute('data-id');\n      if (!confirm('Delete this salutation?')) {\n        return;\n      }\n      try {\n        showLoading();\n        const res = await fetch(`/api/v3/salutations/${id}`, {\n          method: 'DELETE',\n          credentials: 'same-origin'\n        });\n        if (!res.ok) {\n          throw new Error('Delete failed');\n        }\n        showToast('Deleted', { variant: 'success' });\n        fetchPage();\n      } catch (err) {\n        console.error(err);\n        showToast('Delete failed', { variant: 'danger' });\n      } finally {\n        hideLoading();\n      }\n    }\n  });\n\n  document.addEventListener('DOMContentLoaded', fetchPage);\n})();\n"],
  "mappings": "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",
  "names": []
}
