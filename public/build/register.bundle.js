(()=>{typeof window.assertBootstrapReady=="function"&&window.assertBootstrapReady("register");function n(e,r,t){if(!e)return;e.innerHTML="";let a=document.createElement("div");a.className=`alert alert-${r} py-2 mb-0`,a.textContent=t,e.appendChild(a)}function d(e){return e?(e.classList.add("was-validated"),e.checkValidity()):!1}var i=document.getElementById("loadingSpinner"),c=()=>{i&&i.classList.remove("d-none","fade")},l=()=>{i&&(i.classList.add("fade"),setTimeout(()=>{i.classList.add("d-none")},150))};async function u(e){e.preventDefault();let r=e.currentTarget,t=document.getElementById("register-result");if(!d(r)){n(t,"danger","Please fix the highlighted fields.");return}let a=Object.fromEntries(new FormData(r));c();try{let s=await fetch("/api/v3/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"same-origin",body:JSON.stringify({email:a.email,password:a.password})});if(s.status===201){n(t,"success","Registration successful. Please check your email to verify your account before logging in."),r.reset(),r.classList.remove("was-validated");return}let o=await s.json().catch(()=>({}));if(s.status===409&&o.error==="EMAIL_EXISTS"){n(t,"warning","That email is already registered. Try logging in.");return}if(s.status===400&&o.error==="WEAK_PASSWORD"){n(t,"danger","Password does not meet the strength policy.");return}if(s.status===403&&o.error==="REGISTRATION_DISABLED"){n(t,"warning","Registration is currently disabled.");return}n(t,"danger","Registration failed. Please try again.")}catch{n(t,"danger","Network error. Please try again.")}finally{l()}}document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("register-form");e&&e.addEventListener("submit",u)});})();
